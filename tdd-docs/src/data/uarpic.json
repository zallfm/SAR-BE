{
  "name": "uarpic",
  "displayName": "UAR PIC",
  "description": "UAR Person in Charge management",
  "functions": [
    {
      "name": "getUarPics",
      "signature": "async getUarPics(app: FastifyInstance, query: any): Promise<PaginatedResponse<UarPic>>",
      "description": "Get paginated list of UAR PICs",
      "category": "service",
      "testScenarios": [
        {
          "id": "uarpic-get-001",
          "name": "Happy Path - Get UAR PICs",
          "phase": "RED",
          "description": "Should return paginated UAR PICs",
          "testCode": "it('should return paginated UAR PICs', async () => {\n  const query = { page: 1, limit: 10 };\n  jest.spyOn(app.prisma.tB_M_UAR_PIC, 'findMany').mockResolvedValue([]);\n  const result = await uarPicService.getUarPics(app, query);\n  expect(result.data).toBeDefined();\n});"
        }
      ],
      "todos": [
        {
          "id": "todo-getUarPics-001",
          "task": "Setup test file: src/tests/unit/uarPic.service.spec.ts",
          "status": "pending",
          "priority": "high",
          "description": "Create test file with describe block"
        },
        {
          "id": "todo-getUarPics-002",
          "task": "Write test: Happy Path - Get UAR PICs",
          "status": "pending",
          "priority": "high",
          "description": "Write test for paginated UAR PIC list"
        },
        {
          "id": "todo-getUarPics-003",
          "task": "Mock app.prisma.tB_M_UAR_PIC.findMany",
          "status": "pending",
          "priority": "high",
          "description": "Mock Prisma findMany for UAR PICs"
        },
        {
          "id": "todo-getUarPics-004",
          "task": "Implement getUarPics function",
          "status": "pending",
          "priority": "high",
          "description": "Query Prisma with pagination and return result"
        },
        {
          "id": "todo-getUarPics-005",
          "task": "Write test: Filter by DIVISION_ID",
          "status": "pending",
          "priority": "medium",
          "description": "Test filtering UAR PICs by division"
        }
      ],
      "bddScenarios": [
        {
          "id": "bdd-getUarPics-001",
          "name": "Feature: Get UAR PICs",
          "description": "As a user, I want to retrieve a list of UAR Person in Charge so that I can view who is responsible for UAR processes",
          "scenarios": [
            {
              "id": "bdd-getUarPics-001-001",
              "name": "Scenario: List UAR PICs Successfully",
              "given": [
                "UAR PICs exist in database",
                "User requests list"
              ],
              "when": [
                "User calls getUarPics with query parameters",
                "System queries Prisma"
              ],
              "then": [
                "System returns paginated response",
                "System includes PIC data with names and emails"
              ],
              "testCode": "it('should return paginated UAR PICs', async () => {\n  const query = { page: 1, limit: 10 };\n  jest.spyOn(app.prisma.tB_M_UAR_PIC, 'findMany').mockResolvedValue([]);\n  const result = await uarPicService.getUarPics(app, query);\n  expect(result.data).toBeDefined();\n});"
            }
          ]
        }
      ]
    },
    {
      "name": "createUarPic",
      "signature": "async createUarPic(app: FastifyInstance, PIC_NAME: string, DIVISION_ID: number, MAIL: string, CREATED_BY: string): Promise<UarPic>",
      "description": "Create new UAR PIC with validation",
      "category": "service",
      "testScenarios": [
        {
          "id": "uarpic-create-001",
          "name": "Happy Path - Create UAR PIC",
          "phase": "RED",
          "description": "Should create UAR PIC when validation passes",
          "testCode": "it('should create UAR PIC', async () => {\n  jest.spyOn(app.prisma.tB_M_UAR_PIC, 'findFirst').mockResolvedValue(null);\n  jest.spyOn(app.prisma.tB_M_UAR_PIC, 'create').mockResolvedValue({ ID: 'PIC001', ... });\n  const result = await uarPicService.createUarPic(app, 'John Doe', 1, 'john@toyota.co.id', 'admin');\n  expect(result).toBeDefined();\n});"
        },
        {
          "id": "uarpic-create-002",
          "name": "Error - Invalid Email Domain",
          "phase": "RED",
          "description": "Should throw error when email is not @toyota.co.id",
          "testCode": "it('should throw error for invalid email', async () => {\n  await expect(uarPicService.createUarPic(app, 'John', 1, 'john@gmail.com', 'admin')).rejects.toThrow(ApplicationError);\n});"
        }
      ],
      "todos": [
        {
          "id": "todo-createUarPic-001",
          "task": "Setup test file: src/tests/unit/uarPic.service.spec.ts (createUarPic section)",
          "status": "pending",
          "priority": "high",
          "description": "Add describe block for createUarPic tests"
        },
        {
          "id": "todo-createUarPic-002",
          "task": "Write test: Happy Path - Create UAR PIC",
          "status": "pending",
          "priority": "high",
          "description": "Write test for successful UAR PIC creation"
        },
        {
          "id": "todo-createUarPic-003",
          "task": "Mock app.prisma.tB_M_UAR_PIC.findFirst for duplicate check",
          "status": "pending",
          "priority": "high",
          "description": "Mock findFirst to return null (no duplicate)"
        },
        {
          "id": "todo-createUarPic-004",
          "task": "Mock app.prisma.tB_M_UAR_PIC.create",
          "status": "pending",
          "priority": "high",
          "description": "Mock Prisma create for UAR PIC"
        },
        {
          "id": "todo-createUarPic-005",
          "task": "Implement createUarPic function",
          "status": "pending",
          "priority": "high",
          "description": "Validate email domain, check duplicates, create via Prisma"
        },
        {
          "id": "todo-createUarPic-006",
          "task": "Write test: Invalid Email Domain Error",
          "status": "pending",
          "priority": "high",
          "description": "Write test that expects error for non-@toyota.co.id email"
        },
        {
          "id": "todo-createUarPic-007",
          "task": "Add email domain validation",
          "status": "pending",
          "priority": "high",
          "description": "Validate MAIL must end with @toyota.co.id"
        },
        {
          "id": "todo-createUarPic-008",
          "task": "Write test: Duplicate PIC_NAME Error",
          "status": "pending",
          "priority": "medium",
          "description": "Write test for duplicate PIC_NAME validation"
        },
        {
          "id": "todo-createUarPic-009",
          "task": "Add duplicate PIC_NAME check",
          "status": "pending",
          "priority": "medium",
          "description": "Check if PIC_NAME already exists before creating"
        }
      ],
      "bddScenarios": [
        {
          "id": "bdd-createUarPic-001",
          "name": "Feature: Create UAR PIC",
          "description": "As a system administrator, I want to create a new UAR Person in Charge so that responsibilities can be assigned",
          "scenarios": [
            {
              "id": "bdd-createUarPic-001-001",
              "name": "Scenario: Create UAR PIC Successfully",
              "given": [
                "Valid PIC data provided (PIC_NAME, DIVISION_ID, MAIL)",
                "Email domain is @toyota.co.id",
                "PIC_NAME does not exist"
              ],
              "when": [
                "Administrator calls createUarPic with valid data",
                "System validates email domain",
                "System checks for duplicates"
              ],
              "then": [
                "System creates UAR PIC in database",
                "System returns created UAR PIC object",
                "System sets CREATED_BY and CREATED_DATE"
              ],
              "testCode": "it('should create UAR PIC', async () => {\n  jest.spyOn(app.prisma.tB_M_UAR_PIC, 'findFirst').mockResolvedValue(null);\n  jest.spyOn(app.prisma.tB_M_UAR_PIC, 'create').mockResolvedValue({ ID: 'PIC001', PIC_NAME: 'John Doe' });\n  const result = await uarPicService.createUarPic(app, 'John Doe', 1, 'john@toyota.co.id', 'admin');\n  expect(result).toBeDefined();\n});"
            },
            {
              "id": "bdd-createUarPic-001-002",
              "name": "Scenario: Create UAR PIC Fails Due to Invalid Email",
              "given": [
                "Email provided is not @toyota.co.id domain",
                "Administrator attempts to create UAR PIC"
              ],
              "when": [
                "Administrator calls createUarPic with invalid email",
                "System validates email domain"
              ],
              "then": [
                "System throws ApplicationError",
                "Error indicates invalid email domain",
                "UAR PIC is not created"
              ],
              "testCode": "it('should throw error for invalid email', async () => {\n  await expect(uarPicService.createUarPic(app, 'John', 1, 'john@gmail.com', 'admin')).rejects.toThrow(ApplicationError);\n});"
            }
          ]
        }
      ]
    },
    {
      "name": "unknown",
      "description": "Handles POST request to /",
      "signature": "GET /",
      "method": "GET",
      "endpoint": "/",
      "testScenarios": [
        {
          "phase": "RED",
          "description": "Test unknown should fail initially",
          "testCode": "it('should unknown', async () => {\n  // TODO: Implement test\n});",
          "expectedResult": "Test should fail"
        },
        {
          "phase": "GREEN",
          "description": "Test unknown should pass after implementation",
          "testCode": "it('should unknown', async () => {\n  // TODO: Implement test\n});",
          "expectedResult": "Test should pass"
        },
        {
          "phase": "REFACTOR",
          "description": "Refactor unknown implementation",
          "testCode": "// TODO: Refactor code\n// All tests should still pass",
          "expectedResult": "Code refactored, tests still pass"
        }
      ],
      "todos": [
        {
          "id": "1",
          "task": "Implement unknown function",
          "status": "pending",
          "priority": "high",
          "description": "Create implementation for unknown"
        }
      ],
      "bddScenarios": [
        {
          "feature": "unknown Feature",
          "description": "As a developer, I want to unknown so that I can handle the request",
          "scenarios": [
            {
              "name": "unknown Success Scenario",
              "given": "Given I have valid request",
              "when": "When I call unknown",
              "then": "Then I should receive successful response",
              "testCode": "// TODO: Implement BDD test"
            }
          ]
        }
      ],
      "dod": {
        "criteria": [
          {
            "id": "dod-1",
            "description": "All test scenarios implemented and passing",
            "status": "PENDING",
            "evidence": ""
          },
          {
            "id": "dod-2",
            "description": "Code coverage meets minimum threshold (70%)",
            "status": "PENDING",
            "evidence": ""
          },
          {
            "id": "dod-3",
            "description": "Error handling implemented for all error cases",
            "status": "PENDING",
            "evidence": ""
          },
          {
            "id": "dod-4",
            "description": "Code reviewed and approved",
            "status": "PENDING",
            "evidence": ""
          },
          {
            "id": "dod-5",
            "description": "Documentation updated",
            "status": "PENDING",
            "evidence": ""
          }
        ],
        "acceptanceCriteria": [
          {
            "id": "ac-1",
            "description": "Test unknown should fail initially",
            "testScenarioId": "unknown-scenario-1",
            "status": "PENDING"
          },
          {
            "id": "ac-2",
            "description": "Test unknown should pass after implementation",
            "testScenarioId": "unknown-scenario-2",
            "status": "PENDING"
          },
          {
            "id": "ac-3",
            "description": "Refactor unknown implementation",
            "testScenarioId": "unknown-scenario-3",
            "status": "PENDING"
          }
        ]
      }
    },
    {
      "name": "id",
      "description": "Handles PUT request to /:id",
      "signature": "DELETE /:id",
      "method": "DELETE",
      "endpoint": "/:id",
      "testScenarios": [
        {
          "phase": "RED",
          "description": "Test id should fail initially",
          "testCode": "it('should id', async () => {\n  // TODO: Implement test\n});",
          "expectedResult": "Test should fail"
        },
        {
          "phase": "GREEN",
          "description": "Test id should pass after implementation",
          "testCode": "it('should id', async () => {\n  // TODO: Implement test\n});",
          "expectedResult": "Test should pass"
        },
        {
          "phase": "REFACTOR",
          "description": "Refactor id implementation",
          "testCode": "// TODO: Refactor code\n// All tests should still pass",
          "expectedResult": "Code refactored, tests still pass"
        }
      ],
      "todos": [
        {
          "id": "1",
          "task": "Implement id function",
          "status": "pending",
          "priority": "high",
          "description": "Create implementation for id"
        }
      ],
      "bddScenarios": [
        {
          "feature": "id Feature",
          "description": "As a developer, I want to id so that I can handle the request",
          "scenarios": [
            {
              "name": "id Success Scenario",
              "given": "Given I have valid request",
              "when": "When I call id",
              "then": "Then I should receive successful response",
              "testCode": "// TODO: Implement BDD test"
            }
          ]
        }
      ],
      "dod": {
        "criteria": [
          {
            "id": "dod-1",
            "description": "All test scenarios implemented and passing",
            "status": "PENDING",
            "evidence": ""
          },
          {
            "id": "dod-2",
            "description": "Code coverage meets minimum threshold (70%)",
            "status": "PENDING",
            "evidence": ""
          },
          {
            "id": "dod-3",
            "description": "Error handling implemented for all error cases",
            "status": "PENDING",
            "evidence": ""
          },
          {
            "id": "dod-4",
            "description": "Code reviewed and approved",
            "status": "PENDING",
            "evidence": ""
          },
          {
            "id": "dod-5",
            "description": "Documentation updated",
            "status": "PENDING",
            "evidence": ""
          }
        ],
        "acceptanceCriteria": [
          {
            "id": "ac-1",
            "description": "Test id should fail initially",
            "testScenarioId": "id-scenario-1",
            "status": "PENDING"
          },
          {
            "id": "ac-2",
            "description": "Test id should pass after implementation",
            "testScenarioId": "id-scenario-2",
            "status": "PENDING"
          },
          {
            "id": "ac-3",
            "description": "Refactor id implementation",
            "testScenarioId": "id-scenario-3",
            "status": "PENDING"
          }
        ]
      }
    }
  ]
}