{
  "name": "uar_division",
  "displayName": "UAR Division",
  "description": "UAR Division management",
  "functions": [
    {
      "name": "list",
      "signature": "async list(params: ListParams, userDivisionId: number): Promise<{ data: UarHeader[]; total: number }>",
      "description": "Get list of UAR headers for division",
      "category": "service",
      "testScenarios": [
        {
          "id": "uar-div-list-001",
          "name": "Happy Path - List UARs",
          "phase": "RED",
          "description": "Should return UAR headers for division",
          "testCode": "it('should return UAR headers', async () => {\n  const params = { page: 1, limit: 10 };\n  jest.spyOn(repo, 'listUars').mockResolvedValue({ data: [], total: 0, workflowStatus: [], completionStats: [] });\n  const result = await uarDivisionService.list(params, 1);\n  expect(result.data).toBeDefined();\n});"
        }
      ],
      "todos": [
        {
          "id": "todo-list-001",
          "task": "Setup test file: src/tests/unit/uarDivision.service.spec.ts",
          "status": "pending",
          "priority": "high",
          "description": "Create test file with describe block"
        },
        {
          "id": "todo-list-002",
          "task": "Write test: Happy Path - List UARs",
          "status": "pending",
          "priority": "high",
          "description": "Write test for UAR headers list"
        },
        {
          "id": "todo-list-003",
          "task": "Mock repository.listUars",
          "status": "pending",
          "priority": "high",
          "description": "Mock repository to return UAR headers"
        },
        {
          "id": "todo-list-004",
          "task": "Implement list function",
          "status": "pending",
          "priority": "high",
          "description": "Call repository.listUars with division filter and return result"
        },
        {
          "id": "todo-list-005",
          "task": "Write test: Filter by userDivisionId",
          "status": "pending",
          "priority": "medium",
          "description": "Test that only UARs for user's division are returned"
        }
      ],
      "bddScenarios": [
        {
          "id": "bdd-list-001",
          "name": "Feature: List UAR Headers by Division",
          "description": "As a division user, I want to view UAR headers for my division so that I can manage UAR processes",
          "scenarios": [
            {
              "id": "bdd-list-001-001",
              "name": "Scenario: List UARs for Division",
              "given": [
                "UAR headers exist for division ID 1",
                "User has division ID 1"
              ],
              "when": [
                "User calls list with division ID",
                "System queries repository"
              ],
              "then": [
                "System returns UAR headers for division",
                "System includes workflow status and completion stats"
              ],
              "testCode": "it('should return UAR headers', async () => {\n  const params = { page: 1, limit: 10 };\n  jest.spyOn(repo, 'listUars').mockResolvedValue({ data: [], total: 0, workflowStatus: [], completionStats: [] });\n  const result = await uarDivisionService.list(params, 1);\n  expect(result.data).toBeDefined();\n});"
            }
          ]
        }
      ]
    },
    {
      "name": "batchUpdate",
      "signature": "async batchUpdate(dto: UarDivisionBatchUpdateDTO, userNoreg: string, userDivisionId: number): Promise<BatchUpdateResult>",
      "description": "Batch update UAR division approvals",
      "category": "service",
      "testScenarios": [
        {
          "id": "uar-div-batch-001",
          "name": "Happy Path - Batch Update",
          "phase": "RED",
          "description": "Should batch update UAR items",
          "testCode": "it('should batch update UAR items', async () => {\n  const dto = { uarId: 'UAR001', decision: 'approve', items: [{ id: '1' }] };\n  jest.spyOn(repo, 'batchUpdate').mockResolvedValue({ workflowUpdateResult: { count: 1 }, userUpdateResult: { count: 1 } });\n  const result = await uarDivisionService.batchUpdate(dto, '123456', 1);\n  expect(result).toBeDefined();\n});"
        }
      ],
      "todos": [
        {
          "id": "todo-batchUpdate-001",
          "task": "Setup test file: src/tests/unit/uarDivision.service.spec.ts (batchUpdate section)",
          "status": "pending",
          "priority": "high",
          "description": "Add describe block for batchUpdate tests"
        },
        {
          "id": "todo-batchUpdate-002",
          "task": "Write test: Happy Path - Batch Update",
          "status": "pending",
          "priority": "high",
          "description": "Write test for successful batch update"
        },
        {
          "id": "todo-batchUpdate-003",
          "task": "Mock repository.batchUpdate",
          "status": "pending",
          "priority": "high",
          "description": "Mock repository to return update results"
        },
        {
          "id": "todo-batchUpdate-004",
          "task": "Implement batchUpdate function",
          "status": "pending",
          "priority": "high",
          "description": "Process batch update for workflow and user updates"
        },
        {
          "id": "todo-batchUpdate-005",
          "task": "Write test: Invalid decision",
          "status": "pending",
          "priority": "medium",
          "description": "Test validation for decision (approve/reject)"
        },
        {
          "id": "todo-batchUpdate-006",
          "task": "Add validation for decision",
          "status": "pending",
          "priority": "medium",
          "description": "Validate decision is 'approve' or 'reject'"
        }
      ],
      "bddScenarios": [
        {
          "id": "bdd-batchUpdate-001",
          "name": "Feature: Batch Update UAR Division Approvals",
          "description": "As a division user, I want to batch update UAR approvals so that I can process multiple items efficiently",
          "scenarios": [
            {
              "id": "bdd-batchUpdate-001-001",
              "name": "Scenario: Batch Update Successfully",
              "given": [
                "UAR items exist for division",
                "User has permission to update",
                "Valid decision (approve/reject) provided"
              ],
              "when": [
                "User calls batchUpdate with decision and items",
                "System processes batch update"
              ],
              "then": [
                "System updates workflow status",
                "System updates user records",
                "System returns batch update result"
              ],
              "testCode": "it('should batch update UAR items', async () => {\n  const dto = { uarId: 'UAR001', decision: 'approve', items: [{ id: '1' }] };\n  jest.spyOn(repo, 'batchUpdate').mockResolvedValue({ workflowUpdateResult: { count: 1 }, userUpdateResult: { count: 1 } });\n  const result = await uarDivisionService.batchUpdate(dto, '123456', 1);\n  expect(result).toBeDefined();\n});"
            }
          ]
        }
      ]
    },
    {
      "name": "id",
      "description": "Handles GET request to /:id",
      "signature": "GET /:id",
      "method": "GET",
      "endpoint": "/:id",
      "testScenarios": [
        {
          "phase": "RED",
          "description": "Test id should fail initially",
          "testCode": "it('should id', async () => {\n  // TODO: Implement test\n});",
          "expectedResult": "Test should fail"
        },
        {
          "phase": "GREEN",
          "description": "Test id should pass after implementation",
          "testCode": "it('should id', async () => {\n  // TODO: Implement test\n});",
          "expectedResult": "Test should pass"
        },
        {
          "phase": "REFACTOR",
          "description": "Refactor id implementation",
          "testCode": "// TODO: Refactor code\n// All tests should still pass",
          "expectedResult": "Code refactored, tests still pass"
        }
      ],
      "todos": [
        {
          "id": "1",
          "task": "Implement id function",
          "status": "pending",
          "priority": "high",
          "description": "Create implementation for id"
        }
      ],
      "bddScenarios": [
        {
          "feature": "id Feature",
          "description": "As a developer, I want to id so that I can handle the request",
          "scenarios": [
            {
              "name": "id Success Scenario",
              "given": "Given I have valid request",
              "when": "When I call id",
              "then": "Then I should receive successful response",
              "testCode": "// TODO: Implement BDD test"
            }
          ]
        }
      ],
      "dod": {
        "criteria": [
          {
            "id": "dod-1",
            "description": "All test scenarios implemented and passing",
            "status": "PENDING",
            "evidence": ""
          },
          {
            "id": "dod-2",
            "description": "Code coverage meets minimum threshold (70%)",
            "status": "PENDING",
            "evidence": ""
          },
          {
            "id": "dod-3",
            "description": "Error handling implemented for all error cases",
            "status": "PENDING",
            "evidence": ""
          },
          {
            "id": "dod-4",
            "description": "Code reviewed and approved",
            "status": "PENDING",
            "evidence": ""
          },
          {
            "id": "dod-5",
            "description": "Documentation updated",
            "status": "PENDING",
            "evidence": ""
          }
        ],
        "acceptanceCriteria": [
          {
            "id": "ac-1",
            "description": "Test id should fail initially",
            "testScenarioId": "id-scenario-1",
            "status": "PENDING"
          },
          {
            "id": "ac-2",
            "description": "Test id should pass after implementation",
            "testScenarioId": "id-scenario-2",
            "status": "PENDING"
          },
          {
            "id": "ac-3",
            "description": "Refactor id implementation",
            "testScenarioId": "id-scenario-3",
            "status": "PENDING"
          }
        ]
      }
    },
    {
      "name": "batchupdate",
      "description": "Handles POST request to /batch-update",
      "signature": "POST /batch-update",
      "method": "POST",
      "endpoint": "/batch-update",
      "testScenarios": [
        {
          "phase": "RED",
          "description": "Test batchupdate should fail initially",
          "testCode": "it('should batchupdate', async () => {\n  // TODO: Implement test\n});",
          "expectedResult": "Test should fail"
        },
        {
          "phase": "GREEN",
          "description": "Test batchupdate should pass after implementation",
          "testCode": "it('should batchupdate', async () => {\n  // TODO: Implement test\n});",
          "expectedResult": "Test should pass"
        },
        {
          "phase": "REFACTOR",
          "description": "Refactor batchupdate implementation",
          "testCode": "// TODO: Refactor code\n// All tests should still pass",
          "expectedResult": "Code refactored, tests still pass"
        }
      ],
      "todos": [
        {
          "id": "1",
          "task": "Implement batchupdate function",
          "status": "pending",
          "priority": "high",
          "description": "Create implementation for batchupdate"
        }
      ],
      "bddScenarios": [
        {
          "feature": "batchupdate Feature",
          "description": "As a developer, I want to batchupdate so that I can handle the request",
          "scenarios": [
            {
              "name": "batchupdate Success Scenario",
              "given": "Given I have valid request",
              "when": "When I call batchupdate",
              "then": "Then I should receive successful response",
              "testCode": "// TODO: Implement BDD test"
            }
          ]
        }
      ],
      "dod": {
        "criteria": [
          {
            "id": "dod-1",
            "description": "All test scenarios implemented and passing",
            "status": "PENDING",
            "evidence": ""
          },
          {
            "id": "dod-2",
            "description": "Code coverage meets minimum threshold (70%)",
            "status": "PENDING",
            "evidence": ""
          },
          {
            "id": "dod-3",
            "description": "Error handling implemented for all error cases",
            "status": "PENDING",
            "evidence": ""
          },
          {
            "id": "dod-4",
            "description": "Code reviewed and approved",
            "status": "PENDING",
            "evidence": ""
          },
          {
            "id": "dod-5",
            "description": "Documentation updated",
            "status": "PENDING",
            "evidence": ""
          }
        ],
        "acceptanceCriteria": [
          {
            "id": "ac-1",
            "description": "Test batchupdate should fail initially",
            "testScenarioId": "batchupdate-scenario-1",
            "status": "PENDING"
          },
          {
            "id": "ac-2",
            "description": "Test batchupdate should pass after implementation",
            "testScenarioId": "batchupdate-scenario-2",
            "status": "PENDING"
          },
          {
            "id": "ac-3",
            "description": "Refactor batchupdate implementation",
            "testScenarioId": "batchupdate-scenario-3",
            "status": "PENDING"
          }
        ]
      }
    },
    {
      "name": "export",
      "description": "Handles GET request to /export",
      "signature": "GET /export",
      "method": "GET",
      "endpoint": "/export",
      "testScenarios": [
        {
          "phase": "RED",
          "description": "Test export should fail initially",
          "testCode": "it('should export', async () => {\n  // TODO: Implement test\n});",
          "expectedResult": "Test should fail"
        },
        {
          "phase": "GREEN",
          "description": "Test export should pass after implementation",
          "testCode": "it('should export', async () => {\n  // TODO: Implement test\n});",
          "expectedResult": "Test should pass"
        },
        {
          "phase": "REFACTOR",
          "description": "Refactor export implementation",
          "testCode": "// TODO: Refactor code\n// All tests should still pass",
          "expectedResult": "Code refactored, tests still pass"
        }
      ],
      "todos": [
        {
          "id": "1",
          "task": "Implement export function",
          "status": "pending",
          "priority": "high",
          "description": "Create implementation for export"
        }
      ],
      "bddScenarios": [
        {
          "feature": "export Feature",
          "description": "As a developer, I want to export so that I can handle the request",
          "scenarios": [
            {
              "name": "export Success Scenario",
              "given": "Given I have valid request",
              "when": "When I call export",
              "then": "Then I should receive successful response",
              "testCode": "// TODO: Implement BDD test"
            }
          ]
        }
      ],
      "dod": {
        "criteria": [
          {
            "id": "dod-1",
            "description": "All test scenarios implemented and passing",
            "status": "PENDING",
            "evidence": ""
          },
          {
            "id": "dod-2",
            "description": "Code coverage meets minimum threshold (70%)",
            "status": "PENDING",
            "evidence": ""
          },
          {
            "id": "dod-3",
            "description": "Error handling implemented for all error cases",
            "status": "PENDING",
            "evidence": ""
          },
          {
            "id": "dod-4",
            "description": "Code reviewed and approved",
            "status": "PENDING",
            "evidence": ""
          },
          {
            "id": "dod-5",
            "description": "Documentation updated",
            "status": "PENDING",
            "evidence": ""
          }
        ],
        "acceptanceCriteria": [
          {
            "id": "ac-1",
            "description": "Test export should fail initially",
            "testScenarioId": "export-scenario-1",
            "status": "PENDING"
          },
          {
            "id": "ac-2",
            "description": "Test export should pass after implementation",
            "testScenarioId": "export-scenario-2",
            "status": "PENDING"
          },
          {
            "id": "ac-3",
            "description": "Refactor export implementation",
            "testScenarioId": "export-scenario-3",
            "status": "PENDING"
          }
        ]
      }
    }
  ]
}